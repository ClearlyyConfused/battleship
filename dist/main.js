(()=>{"use strict";class r{constructor(){this.boardArray=[["","","","","",""],["","","","","",""],["","","","","",""],["","","","","",""],["","","","","",""],["","","","","",""]],this.gameStatus=!0}addShip(r,e,t,a){if(e=parseInt(e),t=parseInt(t),"h"===a&&this.checkMoveH(r,e,t))this.addShipH(r,e,t);else{if("v"!==a||!this.checkMoveV(r,e,t))throw"Error, cannot place here!";this.addShipV(r,e,t)}}addShipH(r,e,t){let a=0;for(;a<r;)this.boardArray[e][t+a]="o",a+=1}addShipV(r,e,t){let a=0;for(;a<r;)this.boardArray[e+a][t]="o",a+=1}checkMoveH(r,e,t){let a=0;for(;a<r;){if(""!==this.boardArray[e][t+a])return!1;a+=1}return!0}checkMoveV(r,e,t){let a=0;for(;a<r;){if(""!==this.boardArray[e+a][t])return!1;a+=1}return!0}fireAt(r,e){if(r>5||e>5||r<0||e<0)throw"Error, out of board";if(!0===this.gameStatus){if("o"===this.boardArray[r][e])this.boardArray[r][e]="x";else if(""===this.boardArray[r][e])this.boardArray[r][e]="m";else if("x"===this.boardArray[r][e]||"m"===this.boardArray[r][e])throw"You already shot here!";this.checkWin()}}checkWin(){for(const r of this.boardArray)for(const e of r)if("o"===e)return;console.log("Game Over!"),this.gameStatus=!1}resetBoard(){this.boardArray=[["","","","","",""],["","","","","",""],["","","","","",""],["","","","","",""],["","","","","",""],["","","","","",""]]}}function e(r){t(r,1,r.player2Board.boardArray),t(r,1,r.player2Board.boardArray),t(r,1,r.player2Board.boardArray)}function t(r,t,a){try{let e=function(){let r=Math.floor(2*Math.random());return 0===r?"v":1===r?"h":void 0}(),o=Math.floor(6*Math.random()),s=Math.floor(6*Math.random());r.addShips(s,o,e,t),i(t,a)}catch(t){e(r)}}function a(r){try{r.checkGameStatus()&&(Math.floor(9*Math.random())>5?function(r){let e=0;for(;e<6;){let t=0;for(;t<6;)if("o"!==r.player1Board.boardArray[e][t])t+=1;else{if("chosen"==(Math.floor(101*Math.random())<=5?"chosen":"not chosen"))return r.player1Board.fireAt(e,t),void i(0,r.player1Board.boardArray);t+=1}e+=1,6===e&&(e=0)}}(r):function(r){let e=Math.floor(6*Math.random()),t=Math.floor(6*Math.random());r.player1Board.fireAt(e,t),i(0,r.player1Board.boardArray)}(r))}catch(e){a(r)}}function o(r,e,t,a,o){if(!1===r.fireMode){let n=a.className.slice(-1),d=a.parentNode.className.slice(-1);"beginFirePhase"===r.addShips(d,n,o,e)&&s(r),i(e,t)}}function i(r,e,t=!1){let a=0,o=0;for(;a<6;){for(o=0;o<6;){let i=document.querySelectorAll(`#boardDisplay${r+1} .row${a} .column${o}`);for(const s of i)s.innerText="",0===r?(s.innerText=e[a][o],"x"===e[a][o]&&(s.style.backgroundColor="red"),"m"===e[a][o]&&(s.style.backgroundColor="lightblue")):1===r&&("o"!==e[a][o]&&(s.innerText=e[a][o]),!0===t&&(s.innerText=e[a][o]),"x"===e[a][o]&&(s.style.backgroundColor="green"),"m"===e[a][o]&&(s.style.backgroundColor="lightblue"));o+=1}a+=1}}function s(r){let e;r.fireMode=!0,document.querySelector("#gamePhase").innerText="Firing Phase",document.querySelector("#phaseDescription").innerText="Attack the enemy board using LMB";let t=0,a=0;for(;t<6;){for(a=0;a<6;)e=document.querySelectorAll(`#boardDisplay2 .row${t} .column${a}`),n(e,r,r.player2Board,t,a,1),a+=1;t+=1}}function n(r,e,t,a,o,i){for(const s of r)s.addEventListener("click",(()=>{d(e,t,a,o,i)}))}function d(r,e,t,o,s){r.checkGameStatus()&&(e.fireAt(t,o),i(s,e.boardArray),a(r))}function h(r,e){let t=0;for(;t<6;){let a=l(r,e);a.setAttribute("class",`row${t}`),document.querySelector(`#${e}`).appendChild(a),t+=1}}function l(r,e){return"boardDisplay1"===e?c(r,0,r.player1Board.boardArray):"boardDisplay2"===e?c(r,1,r.player2Board.boardArray):void 0}function c(r,e,t){let a=0,o=document.createElement("div");for(;a<6;){let i=u(r,e,t,a);o.appendChild(i),a+=1}return o}function u(r,e,t,a){let i=document.createElement("div");return i.setAttribute("class",`column${a}`),i.addEventListener("click",(()=>{o(r,e,t,i,"v")})),i.addEventListener("contextmenu",(a=>{a.preventDefault(),o(r,e,t,i,"h")})),i}function y(r){r.startGame(prompt),document.querySelector("#boardDisplay1 ").innerHTML="",document.querySelector("#boardDisplay2 ").innerHTML="",h(r,"boardDisplay1"),h(r,"boardDisplay2"),e(r),document.querySelector("#gamePhase").innerText="Placement Phase",document.querySelector("#phaseDescription").innerText="Place your ships using LMB (vertical) and RMB (horizontal)"}document.querySelector("#resetGame").addEventListener("click",(()=>{y(p)})),document.querySelector("#fireAt").addEventListener("click",(()=>{s(p)})),document.querySelector("#displayShipsAI").addEventListener("click",(()=>{i(1,p.player2Board.boardArray,!0)}));let p=new class{constructor(){this.player1Board=new r,this.player2Board=new r,this.boards=[this.player1Board,this.player2Board],this.ship1=[!1,!1],this.ship2=[!1,!1],this.ship3=[!1,!1],this.fireMode=!1}startGame(){this.player1Board.gameStatus=!0,this.player2Board.gameStatus=!0,this.ship1=[!1,!1],this.ship2=[!1,!1],this.ship3=[!1,!1],this.fireMode=!1,this.player1Board.resetBoard(),this.player2Board.resetBoard()}addShips(r,e,t,a){let o;return!1===this.ship1[a]?o=3:!1===this.ship2[a]?o=4:!1===this.ship3[a]&&(o=5),!1===this.ship1[a]?(this.boards[a].addShip(o,r,e,t),void(this.ship1[a]=!0)):!1===this.ship2[a]?(this.boards[a].addShip(o,r,e,t),void(this.ship2[a]=!0)):!1===this.ship3[a]?(this.boards[a].addShip(o,r,e,t),this.ship3[a]=!0,"beginFirePhase"):void 0}checkGameStatus(){return!0===this.player1Board.gameStatus&&!0===this.player2Board.gameStatus}};y(p)})();